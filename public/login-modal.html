<!-- Ù†Ø§ÙØ°Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
<div class="modal fade" id="passwordModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">

      <!-- Ø±Ø£Ø³ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ -->
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title">ğŸ”’ ØµÙØ­Ø© Ù…Ø­Ù…ÙŠØ© - ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h5>
      </div>

      <!-- Ø¬Ø³Ù… Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ -->
      <div class="modal-body text-center">
        <!-- Ø£ÙŠÙ‚ÙˆÙ†Ø© Ù‚ÙÙ„ ÙƒØ¨ÙŠØ±Ø© -->
        <div class="mb-3">
          <i id="lockIcon" class="bi bi-shield-lock-fill" style="font-size:3rem; color:#0d6efd;"></i>
        </div>
        <!-- Ø±Ø³Ø§Ù„Ø© ØªÙˆØ¶ÙŠØ­ÙŠØ© -->
        <p class="fw-bold text-muted mb-3">
          Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ù…Ø­Ù…ÙŠØ©ØŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©
        </p>
        <!-- Ø­Ù‚Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± -->
        <input type="password" id="dashboardPassword" class="form-control" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" lang="en" autofocus>
      </div>

      <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ -->
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="cancelBtn">Ø¥Ù„ØºØ§Ø¡</button>
        <button type="button" class="btn btn-primary" id="confirmDashboardAccess">Ø¯Ø®ÙˆÙ„</button>
      </div>
    </div>
  </div>
</div>

<style>
/* âœ¨ Ø­Ø±ÙƒØ© Ø§Ù‡ØªØ²Ø§Ø² */
@keyframes shake {
  0% { transform: translateX(0); }
  20% { transform: translateX(-5px); }
  40% { transform: translateX(5px); }
  60% { transform: translateX(-5px); }
  80% { transform: translateX(5px); }
  100% { transform: translateX(0); }
}
.shake {
  animation: shake 0.4s;
}
</style>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const passwordModal = new bootstrap.Modal(document.getElementById("passwordModal"), {
    backdrop: 'static',
    keyboard: false
  });
  passwordModal.show();

  const passwordInput = document.getElementById("dashboardPassword");
  const confirmBtn = document.getElementById("confirmDashboardAccess");
  const cancelBtn = document.getElementById("cancelBtn");
  const lockIcon = document.getElementById("lockIcon");

  // âœ… ØªØ±ÙƒÙŠØ² Ø§Ù„Ù…Ø¤Ø´Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
  passwordInput.focus();

  // âœ… ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªØ­Ù‚Ù‚
  async function verifyPassword() {
    const section = "dashboard"; // Ù…Ù‡Ù…: Ø­ØªÙ‰ ÙŠØªÙˆØ§ÙÙ‚ Ù…Ø¹ index.html
    const password = passwordInput.value;

    const res = await fetch("/api/verify-password", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ section, password })
    });

    if (res.status === 200) {
      passwordModal.hide();
      // ğŸ”¹ Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ø¬Ø§Ø­ â†’ ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¬Ù„Ø³Ø©
      sessionStorage.setItem("loggedInAt_" + section, Date.now().toString());
      window.location.href = section + ".html";
    } else {
      // âœ¨ Ø§Ù‡ØªØ²Ø§Ø² Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© + ØªØºÙŠÙŠØ± Ø§Ù„Ù„ÙˆÙ† Ù„Ù„Ø£Ø­Ù…Ø±
      lockIcon.classList.add("shake");
      lockIcon.style.color = "red";

      setTimeout(() => {
        lockIcon.classList.remove("shake");
        lockIcon.style.color = "#0d6efd"; // Ø£Ø²Ø±Ù‚ Ø§ÙØªØ±Ø§Ø¶ÙŠ
      }, 1500);

      passwordInput.value = "";
      passwordInput.focus();
    }
  }

  // Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø¯Ø®ÙˆÙ„
  confirmBtn.addEventListener("click", verifyPassword);

  // âœ… Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter
  passwordInput.addEventListener("keydown", function (e) {
    if (e.key === "Enter") verifyPassword();
  });

/*  // âœ… Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø¥Ù„ØºØ§Ø¡ â†’ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
  cancelBtn.addEventListener("click", function () {
    window.location.href = "index.html";
  }); */
});
</script>
